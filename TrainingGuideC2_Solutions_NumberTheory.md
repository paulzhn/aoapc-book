#《算法竞赛入门经典——训练指南》第二章数论部分习题简要题解

提示：以下题解可以用于任何非盈利用途，但请注明出处，一是尊重作者的劳动，二是让更多的人知道这个题解的存在，大家共同维护 :)

如果你想contribute的话，直接以留言或者email的形式把题解发给我们，或者先写一篇长长的blog，再告知链接 :)

# 数论 （Number Theory） #

## UVa10061 多少0多少位(How many zero's and how many digits?) ##

[题目大意]

给出整数N和B，计算N!的B进制表示形式是多少位，以及多少个尾随的0。

[分析]

(by 陈锋)

如果 B<sup>(m-1)<= n！<= B</sup>m，则m就是所求的位数，可以用求对数的方法来求m的值。
使 n! mod (B^x)等于0的最大的x值就是所求的尾随0的个数。我们对B进行素数唯一分解，同时针对所有不大于B的素数对n!进行唯一分解。则根据两个分解结果中素数的次数，就很容易计算出x的值。

需要注意的，就是浮点数的精度问题。在求位数的时候，需要对和加一个1e-9再floor才能正确。

## UVa10090 大理石(​​Marbles) ##

[题目大意]

有n 个弹珠，我想买一些盒子来装这些弹珠。盒子有两种：
第一种盒子：每个盒子要价c1元，可以装n1个弹珠。
第二种盒子：每个盒子要价c2元，可以装n2个弹珠。
希望用到的每个盒子都装满，同时希望买盒子的钱花费最少。计算出两种盒子的购买数量。

[分析]

(by 陈锋)

先求方程 n1 `*` x + n2 `*` y = gcd(n1, n2) 的整数解(x,y)。则方程n1 `*` x + n2 `*` y = n的所有整数解都可以写成 x + k `*` n2/g, y - k `*` n1/g。
接下来求出让两者都非负的k的范围。对于M个弹珠，全部用第一种盒子装，花费是 M/n1 `*` c1，若用第二种盒子装，则花费为 M/n2 `*` c2。显然有如果c1 `*` n2 <= c2 `*` n1，x越大花费越少，则k取最大值，反之k取最小值。

需要注意的是，若求出的k的范围无效或者方程无解，则最终问题无解。

## UVa 10110 Light, m​​ore light(点亮更多灯) ##

[题目大意]

学校有一个工友他负责开关走廊中的电灯泡。每个灯泡有他自己的开关。也就是说你按下某个灯泡的开关，灯泡就亮了。下一次你再按这个开关，这个灯泡就熄了。这个工友有个古怪的习惯，假如走廊有n个灯泡（编号从1到n），他会来回走上n趟。在第i 趟开始走过去的时候，他会开关灯泡编号可以除尽i 的灯泡，在回来的时候不做任何事。
现在你的任务就是要算出在走完n趟之后，最后一个电灯泡（编号n）是亮着的还是暗着的。假设刚开始时所有的电灯都是暗着的。

[分析]

(by 陈锋)

不难发现，如果n的所有因子个数为偶数个，则n对应的电灯就被按了偶数次。除了完全平方数的因子个数为奇数个之外，其它都是偶数个。所以这个题目实际上就成了判断n是否是完全平方数。

## UVa10127 很多1(Ones) ##

[题目大意]

对于自然数n，其某一个倍数以十进位的表示法将是一连串的1，请问这一连串的1最少是几位数？

[分析]

(by 陈锋)

按照所求倍数包含的1的倍数i依次往大了遍历，需要注意的是，这个倍数可能会很大，其实利用求模运算，可以只保留i % n就可以了。

## UVa 10162 最后一位(Last Digit) ##

[题目大意]

给出一个整数N (1<=n<=2×10<sup>100</sup>)。定义S = 1<sup>1</sup> + 2<sup>2</sup> + 3<sup>3</sup> +… + N<sup>N</sup>，计算出S的最后一位。

[分析]

(by 陈锋)

数论-模运算，经实验，S(N)是有100的周期的。这样，每次输入一个字符串，取最后两个数字，拼成一个新的数n，剩下就是暴力运算了，也可以提前把0~99的结果算好存下来。

## UVa 10368 欧几里德的游戏(Euclid's Game) ##

[题目大意]

两个玩家玩个游戏，开始时候有两个自然数。Stan，第一个玩家，从较大的整数中减去较小的整数的任意正数倍，并且保证结果非负。Ollie，第二个玩家，对结果两个数做同样的动作，如此轮流下去。直到有个玩家能从较大的整数中减去较小的数的整数倍并且结果是0，那么他就赢了。给出初始的两个数，判断最后的赢家。

[分析]

(by 陈锋)

对于任意的局面(a,b)，不妨设a > b。如果a%b ==0 则显然先手赢。否则就遍历所有可能给对手造成的局面 a - x `*` b, b，只要能给对手留一种先手必输的局面，当前局面就是先手必胜了。否则就是先手必输。

## UVa 10325 彩票(The Lottery) ##

[题目大意]

给出整数N，以及M个整数。找出1-N之间，哪些不能被M个数中的任意一个整除。因为任何一个数都可以被1整除，所以这M个数不会包含1。

[分析]

(by 陈锋)

所有M个数的子集S，都求出Lcm，这个求Lcm的过程可以做成记忆化的DP。然后对于N个数字，使用容斥原理对所有S进行过滤。

## UVA 10616 可被整除的一组数的和(Divisible Group Sums) ##

[题目大意]

给出N个数的列表，可以从中选择M个。所以可选的方案就有C(N, M)种。你要找出其中有多少种方案之中M个数的和是可以被D整除的。

[分析]

(by 陈锋)

```
我们定义状态S = 
{
n, // 剩余下的数组的长度
m, // 要从中选择的元素个数
r, // 期望的除以D的余数
}
```
定义dp(S) 为对应的方案个数。刚开始的时候, n = N, m= M，R = 0。
每次决策，要选择方案中的最后一个数字的序号i
状态转移方程:
```
dp(S) = ∑ dp(i, m - 1, (D  +  r - Num`[`i]%D)%D), 其中，i ∈ [m - 1 ... n )
```

边界：
当n < m的时候，自然是return 0了。
当m = 1的时候，线性遍历出所有的结果。
当n == m的时候，直接遍历计算结果。

注意当num为负数时候的计算应该是： num`[`i] = (num`[`i]%D+D)%D

## UVa 10673 玩转Floor和Ceil(Play with Floor and Ceil) ##

[题目大意]

对于任意的整数x和k，存在两个整数p和q满足：
![http://uva.onlinejudge.org/external/106/p10673a.gif](http://uva.onlinejudge.org/external/106/p10673a.gif)
现在给出x和k的值，找出符合条件的p和q。

[分析]

(by 陈锋)

直接应用入门经典p180 - 提示10.2的结论便可。

## UVa 10990 另一个新函数(Another New Function) ##

[题目大意]

一个数的phi值的深度就是其达到1的步骤数。这里有个例子说明这个情况：
Φ(13)=12 ...... 步骤 1
Φ(12)=4 ...... 步骤2
Φ(4)=2 ...... 步骤3
Φ(2)=1 ...... 步骤4
所以phi(13)的值就是4.我们把这个函数命名为depthphi。所以depthphi(13) = 4。depthphi函数的和(SODF)接受两个整数作为参数并且定义如下：
SODF(m,n) = Σdepthphi(i), m <= n，i ∈ [m, n]，现在给出m和n的值，计算出SODF(m,n)的值。

[分析]

(by 陈锋)

预先把所有的phi算好存起来。这步的时间复杂度是是O(nloglogn)。
则dphi(i) = dphi(phi(i)) + 1 // 这个可以dp存下来，边界就是dphi(1) = 0, dphi(2) = 1。这个也是O(n)
再进一步令 sumdphi(n) = ∑dphi(i) for i = 1 to n，这个可以在O(n)时间内刷出来
前面的这些可以在O(nloglogn) + 2O(n)的时间内全部完成。
则对于m,n，则SODF(m, n) = sumdphi(n) - sumdphi(m-1)，每个Query就都是O(1)了。

## UVa 11180 - i-1进制(Base i-1) ##

[题目大意]

如果一个复数a + bi中，a和b都是整数，那么就称为复整数。
一个复整数n可以写成i-1进制(其中i^2 = -1)，包含一系列的数字(bk)，从右往左写。每一个都是0或者1，无符号的，并且符合下面的等式：
n = b0 + b1(i-1) + b2(i-1)<sup>2 + b3(i-1)</sup>3 + ...
有趣的是，每一个复整数都有一个唯一的i-1进制的表示形式，不需要任何负号。现在要找到这个表示形式。

[分析]

(by 陈锋)

(x+yi)(i-1)=a+bi => x-y=b x+y=-a
当a+b为偶数的时候，b0 = 0，剩余部分由(i-1)(x+yi)表示。x,y = (b-a+1)/2, (-a+1-b)/2
否则b0=1，剩余部分也是由(i-1)(x+yi)表示，(b-a)/2, (-a-b)/2。这样递归的计算出(x+yi)就行。

## UVa 11287 伪素数(Pseudoprime numbers) ##

[题目大意]

费马有个理论假设对于任意的素数p和任意整数a > 1, a^p ≡ a(mod p)。也就是说我们计算a的p次方并且再除以p，余数还是a。
有些非素数的p，对于某些a也有此种性质，我们称这个p为基于a的伪素数。给出2 < p ≤ 1,000,000,000 和 1 < a < p，计算p是否是一个基于a的伪素数。

[分析]

(by 陈锋)

素数筛选，求幂取模。

## UVa 11317 GCD+LCM ##

[题目大意]

给出N的值，你需要找出G和L写成googol(10100)进制时候有几位。G和L的定义如下：
![http://uva.onlinejudge.org/external/113/p11317_1.gif](http://uva.onlinejudge.org/external/113/p11317_1.gif) ![http://uva.onlinejudge.org/external/113/p11317_2.gif](http://uva.onlinejudge.org/external/113/p11317_2.gif)
如果你对符号∏不熟悉，下面给出一个例子：![http://uva.onlinejudge.org/external/113/p11317_4.gif](http://uva.onlinejudge.org/external/113/p11317_4.gif)
这里GCD(i,j)意思就是i和j的最大公约数，LCM(i,j)意思就是i和j的最小公倍数。

[分析]

(by 陈锋)

以下的lg为以10为底的对数：
```
定义Xn = lg(Gn), Cn = ∑lg(gcd(i, n)), i = 1 ~ n-1
定义 Xn - Xn-1 = Cn
Cn=lg(∏(gcd(i, n))), i = 1 ~ n-1 
= lg( ∑s^(phi(n/s)) ), s|n
= ∑s×lg(phi(n/s)), s|n
```
Cn，Xn都可以用筛法从小到大全部算出来。
那个Ln = (n!)n-1/Gn 则 Lg(Ln) = (n-1)∑lgi - Xn, i = 1 ~ n
对于一个数知道其对数x之后，就知道它10进制有x位，那么10^100进制的位数就是ceil(x/100)了。