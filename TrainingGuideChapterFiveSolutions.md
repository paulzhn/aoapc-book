#《算法竞赛入门经典——训练指南》第五章习题简要题解

提示：以下题解可以用于任何非盈利用途，但请注明出处，一是尊重作者的劳动，二是让更多的人知道这个题解的存在，大家共同维护 :)

如果你想contribute的话，直接以留言或者email的形式把题解发给我们，或者先写一篇长长的blog，再告知链接 :)

# DFS及其应用（Depth First Search） #
## UVa11396 爪分解(Claw Decomposition) ##

[题目大意]

给一个n个结点（n<=300）的简单无向图，每个点的度数均为3。你的任务是判断能否把它分解成若干个爪（即K1,3，如下图）。在你的分解方案中，每条边必须恰好属于一个爪，但同一个结点可以出现在多个爪里。

[分析]

## LA3486 (Cells) ##

[题目大意]

有一种细胞分裂的过程是这样的，初始的一个细胞(标记为0)，开始分裂之后它的子孙都按照在家谱树中的深度依次标记(请参加题目中的图示)。现在对于任意个细胞，需要你计算出其中一个是不是另外一个的直系祖先。

[分析]

(by 陈锋)

首先根据题目的输入构造一颗符合要求的树，然后对进行DFS，在DFS的过程中计算每个结点的时间戳pre和post。根据时间戳的性质，结点a是b的祖先等价于pre(a) < pre(b) && post(a) > post(b)。需要注意的是，用递归进行dfs的话，会stack overflow，要使用一个辅助的stack把递归化为迭代。

## UVa 10765 鸽子和炸弹(Doves and Bombs) ##

[题目大意]

给定一个n个点的连通的无向图，一个点的“鸽子值”定义为将它从图中删去后连通块的个数。求每个点的“鸽子值”。

[分析]

(by 陈锋)

需要求出图中所有的点-双连通分量(bcc)。对于点u，如果u是割顶，则鸽子值就是它周围相连的bcc个数；否则，u属于一个bcc，就算删除，整个图依然连通的，所以鸽子值是1。


## UVa11294 婚宴(Wedding) ##

[题目大意]

有n（n<=30）对夫妻参加一个婚宴。所有人都坐在一个长长的餐桌左侧或者右侧，新郎和新娘面对面坐在桌子的两侧。由于新娘的头饰很复杂，她无法看到和她坐在餐桌同一侧的其他人，但能看到餐桌另一侧的所有人。任意一对夫妻不能坐在桌子的同侧，另外还有m对人吵过架，而新娘不希望同时看到两个吵过架的人。你的任务是安排每个人坐在餐桌的哪一侧，使得上述条件全部满足。

[分析]

(by 陈锋)

对于第i对夫妻(i = 0 to n - 1)来说，xi = (i的wife坐在bride的同一侧)，所以一开始就要限定，x0 = true。则所有的输入，就可以转换为2-SAT模型中的一个条件。下面是几个输入转换的例子：
| 3h 7h --> 3h 或者 7h必须有一个坐在bride同一侧 x3 = false or x7 == false |
|:------------------------------------------------------------|
| 5w 3w --> 5w 或者 3w必须有一个坐在bride同一侧 x5 = true  or x3 == true  |
| 7h 3w --> 7h 或者 3w必须有一个坐在bride同一侧 x7 = false or x3 == true  |

# 最短路及其应用（Shortest Paths） #

## UVa10603 倒水(Fill) ##

[题目大意]

有三个没有刻度的水壶，容量分别为a，b和c（单位为升，都是<=200的正整数）。初始时前两个水壶是空的，而第三个装满了水。每次可以从一个水壶往一个水壶里倒水，直到一个水壶倒空或者另一个水壶倒满。为了让某个水壶恰好有d升水，至少要倒多少升的水？如果无解，找一个小于且最接近d的d’代替d。

[分析]

(by 陈锋)

用一个状态(a, b)来描述三个水壶在任一时刻的状态，则状态共有`n = (A+1)*(B+1)`个，则每个状态对应一个0到n之间的整数，遍历每个[0, n]之间的整数i，分别模拟各种倒水动作(从一个杯子到另外一个杯子)，就可以求出每个点所能转移到的状态点，以及其距离(倒水的水量)。这样所有的状态点形成一个有向图，用dijkstra求出从初始点到每个点的最短距离，然后遍历每一个符合目标要求的状态点即可得到答案。

## UVa10269 超级马里奥大冒险 (Adventure of Super Mario) ##

[题目大意]

再次成功营救出桃子公主之后，马里奥需要从Bowser魔王的城堡返回他的家。马里奥世界里一共有A个村庄和B个城堡（1<=A,B<=50），其中村庄编号为1到A，城堡编号为A+1到A+B。马里奥住在村庄1，而Bowser住在城堡A+B。

马里奥能以1公里/小时的速度沿着村庄和城堡之间的双向道路行走，也可以用魔法鞋加速。魔法鞋可以让马里奥瞬间移动不超过L（L<=50）公里，但由于城堡中有很多陷阱，稍不留神就会中招，因此马里奥从不使用魔法鞋穿过城堡。另外，使用魔法鞋的起点和终点都只能是城堡或者村庄，且最多只能使用K（K<=10）次魔法鞋。
你的任务是计算马里奥回家的最短时间。输入保证马里奥一定能回家。

[分析]

(by 陈锋)

首先进行预处理，算出从每个点loc出发，用一次魔法鞋能到达的所有点，具体就是使用Dijkstra算法来计算和loc最小距离小于L的所有点。
然后构造状态空间，每一个状态包含两个值：当前的位置，魔法鞋能够使用的剩余次数。则状态转移边有两种：一种就是普通的沿着一条路走，位置改变，次数不变，这条边距距离就是这条路的距离。另一种就是用一次魔法鞋，位置改变，次数减1，这种状态边的距离为0。初始状态就是(0, K)，目标状态就是(n-1, 任意)，对整个状态空间的每一个状态点使用Dijkstra求出到初始状态的最短距离。则符合对目标状态要求的所有点到初始点的最短距离就是所求的答案。

# 最小生成树（Minimal Spanning Tree and Variants） #

## UVa10600 ACM竞赛和停电(ACM Contest and Blackout) ##

[题目大意]

为了举办ACM竞赛，市长决定给所有n（3<=n<=100）所学校提供可靠的电力供应。一个学校有可靠供应，当且仅当它直接连到电站，或者说已经连到一个有可靠供应的另外一个学校。现在给出在不同的学校之间布线成本，找出最便宜的两种连线方案。一个方案的成本等于其中所有学校之间连线的成本的总和。

[分析]

(by 陈锋)

这道题目可以用5.4节讲到的次小生成树进行建模，这里不再详细描述。

## LA3887 生成树的苗条度(Slim Span) ##

[题目大意]

给一个n（2<=n<=100）结点的无向图，找一棵苗条度（最大边减最小边的值）最小的生成树。图保证不含自环和重边。

[分析]

(by 陈锋)

因为目标值包含两个参数，对其中一个参数固定下来来遍历。这里，我们从小到大遍历原图最小边的值，然后求对应的子图的最小生成树的最大边值。

# 二分图匹配（Bipartite Graph Matching） #

## LA3276  The Great Wall Game ##

[题目大意]

在一个n\*n的棋盘上有n个棋子，要求通过移动棋子使棋子的排布满足以下情况之一：呈横行排列；呈纵行排列；呈对角线排列(有两条)。棋子移动一个单元格的费用为1，总费用为所有棋子的移动费用之和。求最小费用。

[分析]

(by 陈锋)

这道题首先是要对目标排布进行遍历。确定目标(满足的情况之一)之后，对于输入的每个棋子i，连接n条边分别到目标中的n个位置，权值为相应的距离的负值。这样构成一个二分图，求边权值最大的匹配之后，这个匹配的权值之和的相反数即为到这个目标的最小费用。

## LA3353 最优巴士线路设计(Optimal Bus Route Design) ##

[题目大意]

给出一个n(n <= 100)个点的有向带权图，找若干个圈，使得每个结点恰好属于一个圈。要求总长度尽量小。注意即使有有向边(u,v)和(v,u)都存在，它们的长度也不一定相同。

[分析]

(by 陈锋)

回路的特点是，每一个点都有一个唯一的前驱和后继。所以可以构造一个二分图，把原图中每个结点i拆成2个结点，ix和iy，输入中的有向边(u,v)和(v,u)分别对应(ux, vy)和(vx, uy)。则这个题目就转化为求二分图的最佳完美匹配。需要注意的是，有可能某些点无法匹配，此时问题无解。

## LA4288 Cat vs. Dog ##

[题目大意]

在一档电视节目中，观众们要在很多猫和狗中间来评选哪些是最受欢迎的，哪些该离场。每一个观众要选择让一个宠物留下，另一个宠物离开，而且他要么是个爱猫的，要么是个爱狗的。所以每一张选票要么投给猫，要么投给狗。只有当一个观众喜爱的宠物最终留下的时候，他才能满意。现在需要你来计算，留下哪些宠物能让最多的观众满意，并且输出满意的观众的最大个数。

[分析]

(by 陈锋)

对观众按照喜欢的宠物是猫还是狗进行分类，每个观众建立一个结点，这样就构造了一个二分图。如果观众u讨厌的刚好是v喜欢的，那么在u,v之间连一条边。则此二分图的最大独立集中点的个数就是所求的答案。最大独立集点的个数=结点数-最大匹配数。

# 网络流（Network Flows） #

## LA2197 Paint the Roads ##

[题目大意]

某国有n个城市，用m条单向道路相连。你的任务粉刷其中一些道路，使得被粉刷的道路组成一些没有公共边的回路，且每个城市恰好在其中k条回路上。被粉刷的所有道路的总长度应尽量小。

[分析]

(by 陈锋)

回路的特点是，每一个点都有一个唯一的前驱和后继。所以可以构造一个图，把原图中每个结点i拆成2个，i和i2，再加上一个源点s和汇点t。从s到i加一条容量为k的边，从i2到t增加一条容量为k的边，费用都为0。对于每条边(u,v)，则在图中增加一条从u到v2，容量为1的边，费用为d(u,v)。求s到t的最小费用最大流f，以及费用cost。如果`f == n * k`，则可以确定每一个i点后会有k个后继，每个i2点也有k个前驱，正好对应原图中的k个回路，所以cost即为合法答案。否则问题无解。

## LA2796 Concert Hall Schedule ##

[题目大意]

一个著名的音乐厅因为财务状况恶化快要破产，你临危受命，试图通过管理的手段来拯救它，方法之一就是优化演出安排，即聪明的决定接受和拒绝哪些乐团的演出申请，使得音乐厅的收益最大化。该音乐厅有两个完全相同的房间，因此各乐团在申请演出的时候并不会指定房间，你只需要随便分配一个即可。每个演出都会持续若干天，每个房间每天只能举行一场演出。申请数目n为不超过1000的正整数，每个申请用三个整数i, j, w描述，表示从第i天演到第j天，愿意支付w元。

[分析]

(by 陈锋)

此题可以用正文中讲到的区间k覆盖模型来解决，其中每个乐团的一个申请(i, j, w)可以看做一个权值为w的[i,j+1)的左闭右开区间，k在这个题目中就是房间的个数2。需要注意的是，s是这个题目中最小的i然后减1，t是所有的j+1中的最大值。相邻点之间的边，要从s开始一直遍历到t。

## LA3268 Jamie's Contact Group ##

[题目大意]

有n(n ≤ 1000)个人和m(m≤500)个组。一个人可能属于很多组。现在请你从某些组中去掉几个人，使得每个人只属于一个组，并使得人数最多的组中人员数目最小。

[分析]

(by 陈锋)

对人数最多的组的人数K进行二分。然后建立如下的图，对于每个人i建立结点，并且加一条容量为1的边(s, i)。对于每个组建立一个结点g，每个组员i加一条容量为1的边(i, g)，同时加一条边(g, t)，容量为k。然后求最大流f，如果f < N，则表示k太小以致无法进行合法分配，增加k的大小重新计算。否则表示k还够大，减少k进行重新计算。最终结果是所有的边(g, t)中，最大的流量。

## LA3487 寡头的竞争(Duopoly) ##

[题目大意]

T公司和M公司想向政府申请一些资源的使用权。每一项申请包含一个资源列表和该公司愿意支付的金额。如果该申请得到批准，该公司将得到列表中所有资源的使用权。政府只能完整的批准或拒绝一个申请，不能只批准申请中的部分资源，也不能将一个资源的使用权同时批给两个公司。同一个公司的两项申请中保证不包含相同的资源。你的任务是帮助政府绝对应当批准哪些申请，使得政府收益最大化，即被批准的那些申请的金额之和最大。

每个公司申请数目n不超过3000，每项申请愿意支付的金额为不超过1000的正整数，每项申请涉及到的资源数为1到32之间的整数。

[分析]

(by 陈锋)

使用二分图模型，对T和M公司的申请分别构造对应的X和Y结点，结点的权值为相应的金额。如果X中的结点u和Y中的结点v包含有相同的资源，则从u到v连一条边。则所求的最大收益就是这个二分图的带权最大独立集的权值之和。

## LA3972 企鹅的游行(March of the Penguins) ##

[题目大意]

网格上有n（n<=100）片荷叶，初始时第i片荷叶上有ni只企鹅（0<=ni<=10）。由于承受力有限，第i片荷叶最多只能有mi（1<=mi<=200）只企鹅能从上面跳走。一只企鹅每次最多跳D（D<=105）单位距离。要求所有企鹅在同一片荷叶上集合。问：哪些荷叶可以成为这个汇合地点？

[分析]

(by 陈锋)

首先对所有的点进行预处理，如果点u,v的距离d<=D，则在u,v之间构造费用为d的两条有向边。然后对可以成为汇合地点的点i进行遍历计算。确定了i之后，使用结点容量模型进行建模：首先增加源点；然后把每一个点u拆成u1, u2，增加一条容量为u对应的mu的边(u1, u2), 接着增加容量为u上的初始的企鹅个数nu的一条边(s, u1)。最后的汇点t就是用从i拆出来的结点i2。求最大流f，如果f>=输入的企鹅个数的总和，则i可以作为汇合地点。

## LA5095 货物运输 (Transportation) ##

[题目大意]

某国有n（n<=100）座城市，由m（m<=5000）条单向道路相连。你希望从城市1运送k（0<=k<=100）单位货物到城市n。这些道路并不安全，有很多强盗，所以你决定雇保镖来保护你。每条道路都有一个危险系数ai（0<ai<=100），如果你带着x个单位货物通过，需要给保镖aix2元钱才能保证你的安全（这是合理的，因为带在身边的货物越多越不安全）。另外，每条路上还有一个容量限制Ci（Ci<=5），表示最多只能带Ci个单位的货物通过。注意，货物不能拆开，因此在通过每条边时，身上的货物数量必须是整数。

[分析]

(by 陈锋)

使用费用与流量平方成正比的最小流模型，书中已经有叙述。

## 最短往返路 UVa10806(Dijkstra, Dijkstra) ##

[题目大意]

给出一个n（n<=100）个结点的带权无向图，找到从起点S到终点T的最短往返路径，不能重复走过同一条边。输入图中不含重边。

[分析]

(by 陈锋)

在原图的基础上，构造一个新的图：首先是增加一个源点s = 0，然后令汇点t = n。增加一条容量为2，费用为0的边(s, 1)。对于原图中的每条边(u,v)在图中增加容量都为1的两条边(u,v)和(v,u)。然后求这个图的最小费用最大流f，如果f==2，则说明有可用的路线，输出相应的费用即可，否则说明问题无解。

## UVa11082 矩阵解码(Matrix Decompressing) ##

[题目大意]

对于一个R行C列的正整数矩阵（1<=R,C<=20），设A[i](i.md)和前i行所有元素之和，B[i](i.md)为前i列所有元素之和。已知道R,C和数组A和B，找一个满足条件的矩阵。矩阵中的元素必须是1到20之间的正整数。输入保证有解。

[分析]

(by 陈锋)

首先要根据输入计算出每一行和每一列的和。然后构图，增加源点s和汇点t；对于每一行增加对应的一个结点r，然后增加一条容量为当前行元素和d - C的边(s, r)；对于每一列增加对应结点c，然后增加一条容量为当前列元素和d-R的边(c, t)；同时对于每一对(r, c)，增加一条容量为20-1的边。然后求(s,t)的最大流f。
这样每一条(r,c)边的流量+1即为符合要求的原矩阵中(r,c)点的元素值。