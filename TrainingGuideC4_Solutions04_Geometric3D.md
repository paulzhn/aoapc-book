#《算法竞赛入门经典——训练指南》第四章 三维几何 习题简要题解

提示：以下题解可以用于任何非盈利用途，但请注明出处，一是尊重作者的劳动，二是让更多的人知道这个题解的存在，大家共同维护 :)

如果你想contribute的话，直接以留言或者email的形式把题解发给我们，或者先写一篇长长的blog，再告知链接 :)

## LA3147(UVa1333) 模型火箭 (Model Rocket Height) ##

[题目大意]

给出都在在水平面上的一条直线L上面的的A,B,C三个点，之间距离都是D。在A,B,C的相距为H的垂直正上方，各有一个点A<sub>0</sub> , B<sub>0</sub> , C<sub>0</sub> ，从这些点来观察在空间中的一个点R。仰角分别为α,β,γ。求
R的高度，也就是和直线L之间的距离。

[分析]

(by 陈锋)

设高度为H + x，可以看出R, A<sub>0</sub> , C<sub>0</sub> 形成一个三角形，RA<sub>0</sub>的长度为x/sin(α)，RB<sub>0</sub> 的长度为x/sin(β)，RC<sub>0</sub> 的长度为x/sin(γ)。B<sub>0</sub>为边A<sub>0</sub>C<sub>0</sub>的中点，RB<sub>0</sub>为边A<sub>0</sub>C<sub>0</sub>的中线。根据中线长度的公式：

![http://upload.wikimedia.org/math/d/1/7/d17a8fd443cf351d370ba16c7699eb3e.png](http://upload.wikimedia.org/math/d/1/7/d17a8fd443cf351d370ba16c7699eb3e.png) [详细 http://en.wikipedia.org/wiki/Median_(geometry)]

可以列出一个方程，推出x =  D / sqrt(0.5/sin<sup>2</sup>(α) + 0.5/sin<sup>2</sup>(β) - 1/sin<sup>2</sup>(γ))，则最终结果就是x + H。


## UVa1360(LA3500) 模型火箭 (Model Rocket Height) ##

[题目大意]

水平面上，距离原点O 50英尺的地方，有一条直线L，L上有两个点A和B，AB的长度为100，且OA, OB等长。在A, B垂直的上方有各有一点C和D，AC, BD的长度分别为HA, HB。从O发射一个火箭，在最高点的时候，从C,D两点进行测量，分别测出看到的仰角和倾斜角。倾斜角指的是，从C，D看过去的两条视线所在的垂直平面和直线AB的夹角。

根据两条视线，可以按照如下逻辑确定火箭的高度：两条视线的公垂线的中点和水平面的距离。

[分析]

(by 陈锋)

根据题意，画出如下的示意图：

![http://wiki.aoapc-book.googlecode.com/git/images/LA3500.png](http://wiki.aoapc-book.googlecode.com/git/images/LA3500.png)

其中初始几个点的坐标是 O(0,0,0), A(50, 50, 0), B(-50, 50, 0), C(50, 50, hA), D(-50, 50, hB)。

从C点看过去的倾斜角就是∠EAB，从D点看过去的倾斜角就是 π - ∠FBA，则根据这些角度可以求出AE以及BF的长度，进而求出E,F的坐标。再根据两个仰角可以求出GI以及HJ的长度，最终求出G和H的坐标。然后求射线CG和DH的中垂线的中点的z坐标即是所求的高度。

## LA3616(UVa1373) 多想认识你!(How I Wonder What You Are!) ##

[题目大意]

首先，给出一系列的点；给出一系列的向量以及对应的夹角。对于一个点p来说，如果从原点出发指向p的向量和给出某个向量的夹角小于等于相应的夹角，则输出表示p是可见的。计算可见的p的个数。

[分析]

(by 陈锋)

直接按照题意遍历并计算即可。


## UVa10794 导弹的距离(The Deadly Olympic Returns) ##

[题目大意]

三维空间中有两枚沿直线匀速飞行的导弹（看作点），已知某时刻它们的位置、飞行方向和速度，求它们的最近距离（假设两枚导弹将按照原来的速度和方向一直飞行）。

[分析]

(by 陈锋)

令输入的点是p1, p2，速度分别是v1, v2。则p2相对于p1的速度就是v = v2 - v1。则所求距离就是求，p1到射线(p2, v)的最短距离。

  * 如果dot(p1-p2, v) < 0，则说明点p1在射线所在直线的投影不在射线上，距离就是p1-p2的长度。
  * 否则，距离就是p1到p1在射线上的投影之间的距离。

需要注意的两点：
  1. 使用long long以避免整数运算溢出，主要是在计算叉积以及点积的时候。
  1. 相对速度v的长度 = 0的情况，此时所求的距离就是输入两个起点之间的距离。


## UVa11836 星球大战(Star War) ##

[题目大意]

空间里有两个行星，均为四面体。求二者的最近距离。

[分析]

(by 陈锋)

首先是计算所有的顶点到另外一个四面体的各个三角形之间最短距离，分两种情况：

  * 点在三角形平面上的投影在三角形内，则最短距离就是点到平面的距离。
  * 否则是点到三个边以及到三角形三个顶点的共6个距离的最小值。

还有一种最短距离可能出现在两条异面直线上的边，并且公垂线的垂足都在两条边上，则两条边的距离就是公垂线的长度，这个长度也可能成为四面体之间的最短距离。